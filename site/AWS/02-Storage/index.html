



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Training Documentation">
      
      
      
        <meta name="author" content="Rafael Nieto Esteve">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.1">
    
    
      
        <title>2. Storage - rnietoe training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#2-storage" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="rnietoe training" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              rnietoe training
            </span>
            <span class="md-header-nav__topic">
              
                2. Storage
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="rnietoe training" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    rnietoe training
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Training index" class="md-nav__link">
      Training index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      AWS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        AWS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../00-AWS-Solutions-Architect-Associate/" title="AWS Architect" class="md-nav__link">
      AWS Architect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01-Introduction/" title="1. Introduction" class="md-nav__link">
      1. Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2. Storage
      </label>
    
    <a href="./" title="2. Storage" class="md-nav__link md-nav__link--active">
      2. Storage
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efs" class="md-nav__link">
    EFS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-an-efs-shared-by-two-ec2-instances" class="md-nav__link">
    How to create an EFS shared by two EC2 instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ebs" class="md-nav__link">
    EBS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fsx-file-systems" class="md-nav__link">
    FSx (File Systems)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-gateway" class="md-nav__link">
    Storage gateway
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-backup" class="md-nav__link">
    AWS Backup
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03-Network/" title="3. Network" class="md-nav__link">
      3. Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../04-Compute/" title="4. Compute" class="md-nav__link">
      4. Compute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05-Security/" title="5. Security" class="md-nav__link">
      5. Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06-Management/" title="6. Management and Governance" class="md-nav__link">
      6. Management and Governance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07-Architecture/" title="7. Hight Availability Architecture" class="md-nav__link">
      7. Hight Availability Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08-Databases/" title="8. Databases" class="md-nav__link">
      8. Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09-Applications/" title="9. Applications" class="md-nav__link">
      9. Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10-Media/" title="10. Media" class="md-nav__link">
      10. Media
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-12" type="checkbox" id="nav-2-12">
    
    <label class="md-nav__link" for="nav-2-12">
      CloudFormation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-12">
        CloudFormation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CloudFormation/06-CloudFormation/" title="CloudFormation" class="md-nav__link">
      CloudFormation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Git
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Git
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/1-Git-Essential-Training_The-Basics/" title="Git Essential Training: The Basics" class="md-nav__link">
      Git Essential Training: The Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/2-Git_Branches-Merges-and-Remotes/" title="Git: Branches, Merges, and Remotes" class="md-nav__link">
      Git: Branches, Merges, and Remotes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/3-Git-Intermediate-Techniques/" title="Git Intermediate Techniques" class="md-nav__link">
      Git Intermediate Techniques
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      React
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        React
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Building-React-and-ASP.NET-Core-Applications/" title="Building React and ASP.NET Core Applications" class="md-nav__link">
      Building React and ASP.NET Core Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Become a React Developer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Become a React Developer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/1-Learning-React-js/" title="Learning React.js" class="md-nav__link">
      Learning React.js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/2-React.js-Essential-Training/" title="React.js Essential Training" class="md-nav__link">
      React.js Essential Training
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Security
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Security/Web-Security-OAuth-And-OpenID-Connect/" title="Web Security: OAuth and OpenID Connect" class="md-nav__link">
      Web Security: OAuth and OpenID Connect
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efs" class="md-nav__link">
    EFS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-an-efs-shared-by-two-ec2-instances" class="md-nav__link">
    How to create an EFS shared by two EC2 instances
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ebs" class="md-nav__link">
    EBS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fsx-file-systems" class="md-nav__link">
    FSx (File Systems)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-gateway" class="md-nav__link">
    Storage gateway
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aws-backup" class="md-nav__link">
    AWS Backup
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rnietoe/Training/edit/master/docs/AWS/02-Storage.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="2-storage">2. Storage<a class="headerlink" href="#2-storage" title="Permanent link">&para;</a></h1>
<p><img alt="" src="../img/storage.PNG" /></p>
<h2 id="s3">S3<a class="headerlink" href="#s3" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS S3</code></strong> (Simple Storage Service) is <strong>object-based</strong> for the safe storage of <strong>flat files</strong> such as text files, videos, pictures and any other flat file from 0 to 5 tb. The object has a key (filename), value (data), versionID, metadata, encryption, and security by <strong>ACL</strong> (Access Control Lists), torrent and Bucket Policies </p>
<div class="admonition info">
<p class="admonition-title">Objects stored in S3 (no One Zone) are stored across at least three AZs</p>
</div>
<p><strong>Buckets</strong> are folders/containers for everything that you store in S3. S3 bucket names are <strong>global</strong>, and must be unique, but they are create in a region. Universal namespaces are like https://s3-region_name.amazonaws.com/bucket_name. </p>
<ul>
<li>The response code is http 200 when file upload succeeds.</li>
<li>Contact AWS to create more than 100 buckets</li>
<li>minimum object size is 0 kb</li>
<li>an object can have up to 10 tags</li>
</ul>
<p>Both Virtual-host-Style (such as: https://bucket-name.s3.Region.amazonaws.com/key name) and Path-Style (such as https://s3.Region.amazonaws.com/bucket-name/key name) URLs are supported, but path-style URLs (soon to be retired) will be eventually depreciated in favor of virtual hosted-style URLs for S3 bucket access. DNS compliant names are also recommended.</p>
<div class="admonition danger">
<p class="admonition-title">Objetcs have eventual consistency: Create new files are read inmediately. Updates and deletes takes a little bit of time to propagate.</p>
</div>
<p>Many other services can store data in S3, including Kinesis Firehose, Storage Gateway and the AWS API</p>
<p>The S3 API is based in <strong>REST</strong> (Representational State Transfer) which uses CRUD methods</p>
<p>S3 classes order by pricing:</p>
<ol>
<li><strong>S3 Standard</strong>: Frequently accessed data. Availability of 99.99%</li>
<li><strong>S3 Standard - IA</strong> (Infrequently Accessed). Availability of 99.9%</li>
<li><strong>S3 One Zone - IA</strong> (when multiple AZ not required) . costs is 20% less than S3 Standard-IA</li>
<li><strong>S3 RRS</strong> (Reduce Redundancy Storage). Availability of 99.5%. RRS is the only S3 Class that does not offer 99.999999999% <strong>durability</strong>. </li>
<li><strong>S3 Glacier</strong> (low cost storage. Retrieval times from 3 minutes to 12 hours). archives stored in vaults(as buckets) with AES 256-bit encryption<ul>
<li>Expedited access within 3-5 min</li>
<li>Standard access within 3-5 hours</li>
<li>Bulk access within 5-12 hours</li>
<li>Up to 5% retrieved at no change</li>
<li><strong>S3 Glacier Vault Lock Policy</strong>: compliance controls for S3 Glacier with a Vault Lock policy. The policy can no longer be changed</li>
<li>Only empty vaults can be deleted</li>
</ul>
</li>
<li><strong>S3 Glacier Deep Archive</strong> (lowest-cost. Retrieval time of 12 hours is acceptable)</li>
</ol>
<p>Enhanced features:</p>
<ul>
<li><strong>S3 - Intelligent Tiering</strong>, using machine learning to move files to the most cost-effective access tier. It does not make sense to use S3 standard. Instead, use S3 - Intelligent Tiering to save money</li>
<li><strong>S3 Batch Operations</strong> create jobs to enable automatic actions</li>
<li><strong>S3 on Outposts</strong> store customer data generated on-premises before moving it to an AWS Region.</li>
<li>
<p><strong>S3 Objetc lock</strong> use <strong>WORM</strong> model (objects are Written Once and Read Many) during bucket creation. Objects (the whole bucket or individual files) became unmodificable and undeletable:</p>
</li>
<li>
<p>Governance mode: some users are grant with permissions to alter settings or delete the object version</p>
</li>
<li>Compliance mode: objects version cannot be modified or deleted, even by the root user</li>
</ul>
<p>More features:</p>
<ul>
<li>Unlimited storage</li>
<li>We can use the bucket to host a <strong>static website</strong> using S3 with option <code>static website hosting</code> enabled, with index.html and error.html. Dynamic website can not be hosted on S3.</li>
<li>Encryption:<ul>
<li>Encryption in Transit, using https (SSL/TLS)</li>
<li>Encryption at Rest:<ul>
<li>In the server side - SSE (Server Side Encryption - 256-bit AES encryption - storage encryption, no transit encryption):<ul>
<li><strong>SSE-S3</strong>: An encryption key that Amazon S3 creates, manages, and uses for you.</li>
<li><strong>SSE-KMS</strong>: An encryption key protected by AWS Key Managament Service</li>
<li><strong>SSE-C</strong> with customer provided keys</li>
</ul>
</li>
<li>In the client side - encrypted before uploading with a client library such as Amazon S3 Encryption Client.</li>
</ul>
</li>
</ul>
</li>
<li>Versioning (disabled by default):<ul>
<li>usefull as backup tool</li>
<li><strong>MFA Delete</strong> setting: an additional layer of security that requires MFA for changing Bucket Versioning settings and permanently deleting object versions. To modify MFA delete settings, use the AWS CLI, AWS SDK, or the Amazon S3 REST API.</li>
<li>Versioning cannot be disabled once enabled</li>
<li>Uploaded new verions are <strong>private</strong> by default</li>
<li>Deleting a file create a new version (<strong>deleted marker</strong>), then restoring the file recovers all previous versions.</li>
<li>Integrated with lifecycle rules</li>
</ul>
</li>
<li>Use <strong>S3 Lifecycle rules</strong> to define actions you want AWS S3 to take during an object's lifetime such as <strong>transitioning</strong> objects to another storage class, archiving them, or deleting them after a specified period of time.</li>
<li>
<p><strong>S3 Transfer Acceleration</strong> takes advantage of Amazon CloudFront (edge location distribution) using Amazon internal network (no internet). It enables fast, easy and secure transfers of files to and from your bucket.</p>
<ul>
<li><a href="https://s3-accelerate-speedtest.s3-accelerate.amazonaws.com/en/accelerate-speed-comparsion.html">Speed Comparison Tool</a></li>
</ul>
</li>
<li>
<p><strong>Cross Region Replication</strong>: replicate a bucket from a region to another:</p>
<ul>
<li>From S3 Management tab, select <code>Create replication rule</code></li>
<li>Create a new role and select the source bucket and destination bucket. Replicated buckets can be in different AWS accounts</li>
<li>Replication requires versioning to be enable on the source and destionation buckets.</li>
<li>we can change the storage class for the replicated objetcs</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">replication starts when files are added and updated later. Deletes, permissions and previous versions are not replicated</p>
</div>
</li>
<li>
<p><strong>Multipart uploads</strong> use multithreading to upload large files to S3 buckets <strong>in parallel</strong> (the parts of the file are uploaded in parallel). Recommended for &gt; 100mb and required for &gt; 5Gb</p>
<ul>
<li>begin an upload before you know the final object size</li>
<li>quick recovery from network issues</li>
<li>improved throughput</li>
<li>allow pause and resume object uploads.</li>
</ul>
</li>
<li><a href="https://aws.amazon.com/s3/faqs/">General S3 FAQs</a></li>
</ul>
<p>To upload a file larger than 160 GB, use the AWS CLI, AWS SDK, or Amazon S3 REST API.</p>
<p>S3 Event notifications:</p>
<ul>
<li>Object Created</li>
<li>Object Removed</li>
<li>Object Restored</li>
<li>RRS Object Lost</li>
<li>Replication</li>
</ul>
<p><a href="https://aws.amazon.com/s3/pricing/">S3 Pricing</a> depends on:</p>
<ul>
<li>Storage class</li>
<li>Storage</li>
<li>Requests</li>
<li>Data transfer</li>
<li>Transfer acceleration</li>
<li>Cross region replication</li>
</ul>
<p>S3 Security:</p>
<ul>
<li>managed in the AWS console and the AWS CLI</li>
<li>Uploaded files are <strong>private</strong> by default</li>
<li>When editing S3 bucket permissions (policies and ACLs), the concept of the <strong>resource owner</strong> refers to he AWS account that creates Amazon S3 buckets and objects.</li>
<li><strong>Bucket ACLs</strong> (legacy): Object policies applies to an individual file.</li>
<li><strong>Bucket policies</strong> applies to the entire bucket - like one hosting a static S3 website <ul>
<li>public sample:
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-09-08&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">identify</span> <span class="err">the</span> <span class="err">document</span> <span class="err">structure</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;PublicReadGetObject&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">statement</span> <span class="err">id</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">allow</span> <span class="err">|</span> <span class="err">deny</span>
            <span class="nt">&quot;Principal&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;s3:GetObject&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:s3:::BUCKET_NAME/*&quot;</span> 
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div></li>
</ul>
</li>
</ul>
<p>S3 Performance:</p>
<ul>
<li>Use <strong>prefixes</strong> and <strong>delimiters</strong> to improve performance: path between the bucket and file</li>
<li>Use SSE-KMS have limitations</li>
<li>Use <strong>Multipart uploads</strong> </li>
<li>Use downloads with <strong>S3 Byte-Range Fetches</strong></li>
<li>Use <strong>S3 Select</strong>/<strong>Glacier Select</strong> using SQL to download only the subset of data we need from ZIP or CSV files </li>
</ul>
<h2 id="efs">EFS<a class="headerlink" href="#efs" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS EFS</code></strong> (Elastic File System) is a mountable <strong>file</strong> storage service for EC2 (<strong>linux</strong>), like a NAS (Network Attached Storage - <strong>shared folder</strong>), based on <strong>NFSv4</strong> (Network File System), but has no connection to S3 which is an <strong>object</strong> storage service.</p>
<ul>
<li>EFS is <strong>shareable</strong>. </li>
<li>there is folder hierarchy </li>
<li>no supported on windows instances</li>
<li>Data is stored across multiple AZ's within a region</li>
</ul>
<h3 id="how-to-create-an-efs-shared-by-two-ec2-instances">How to create an EFS <strong>shared</strong> by two EC2 instances<a class="headerlink" href="#how-to-create-an-efs-shared-by-two-ec2-instances" title="Permanent link">&para;</a></h3>
<ol>
<li><code>Create file system</code> from AWS EFS</li>
<li>
<p>Create EC2 instances with following user data: </p>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>
yum update -y
yum install httpd -y
service httpd start
chkconfig httpd on
yum install amazon-efs-utils -y
</pre></div>

</li>
<li>
<p>default SG require inbound rule of type NFSv4 (port 2049) with source SG WebDMZ</p>
</li>
<li>
<p>connect to the EC2 instances, and then mount EFS using the command from <code>EFS - Amazon EC2 mount instructions from local VPC</code>:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> /var/www/html
<span class="nb">cd</span> ..
mount -t efs -o tls fs-9816b269:/ /var/www/html  
<span class="nb">cd</span> html
<span class="nb">echo</span> <span class="s2">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;using EFS&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span> &gt; index.html
</pre></div>

</li>
</ol>
<h2 id="ebs">EBS<a class="headerlink" href="#ebs" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS EBS</code></strong> (Elastic Block Storage) is like a virtual hard disk in the cloud. This is a <strong>block</strong> service used for <strong>durable</strong> storage in EC2 instances and again has no connection to S3.</p>
<ul>
<li>EBS cannot be shared by two EC2 instances</li>
<li>EBS volume can be attached to any EC2 instance in the same AZ</li>
<li>EBS volume attached as an additional disk (not the root volume) can be detached without stopping the instance</li>
</ul>
<p>EBS Types:</p>
<ul>
<li><strong>SSD</strong> (Solid State Drive)<ul>
<li>GP2 - General Purpose</li>
<li>IO1 - Provisioned IOPS - from 10.000 to 32.000 Input Output per second - high performance</li>
</ul>
</li>
<li>
<p><strong>HDD</strong> (Hard Disk Drive)</p>
<ul>
<li>ST1 - Throughtput optimised - Low cost for frequently access</li>
<li>SC1 - Cold HDD - Lowest cost for less frequently access</li>
<li>Magnetic - Previous generation</li>
</ul>
<p>HDD based volumes will always be less expensive than SSD types. </p>
<p>an <strong>EBS-optimized</strong> EC2 instance should be used for high performance. No availabled in EC2 free-tier</p>
</li>
</ul>
<p><img alt="" src="../img/ebs.PNG" /></p>
<p>EBS Pricing depends on:</p>
<ul>
<li>Volumes</li>
<li>Snapshots</li>
<li>Data transfer</li>
<li>volume recovery (attaching volumes from own intances to another)</li>
</ul>
<p>Although there is no direct way to encrypt an existing unencrypted volume or snapshot, you can encrypt them by creating either a volume or a snapshot.</p>
<h2 id="fsx-file-systems">FSx (File Systems)<a class="headerlink" href="#fsx-file-systems" title="Permanent link">&para;</a></h2>
<ul>
<li>AWS FSx for <strong>windows file server</strong><ul>
<li>Based on <strong>SMB</strong> (Windows Server Message Block)</li>
</ul>
</li>
<li>AWS FSx for <strong>Lustre</strong><ul>
<li>Optimised file system</li>
<li>can store data on S3</li>
</ul>
</li>
</ul>
<p>can be deploy in single or multi AZ</p>
<p>windows authentication using Active Directory self manage or by AWS</p>
<h2 id="storage-gateway">Storage gateway<a class="headerlink" href="#storage-gateway" title="Permanent link">&para;</a></h2>
<p>connect on-premise software with cloud-based storage (S3) using AWS storage as local storage.</p>
<ul>
<li><strong>File Gateway</strong>. Store files as objects in Amazon S3, with a local cache for low-latency access to your most recently used data.</li>
<li><strong>Volume Gateway</strong>: objects are hard disk drives. It looks like EBS snapshots. there are storage volumes (entire dataset) and cached volumes<ul>
<li>Gateway-Cached volumes allow you to store your data in S3 and retain a copy of frequently accessed data subsets locally. Cached volumes offer a substantial cost savings on primary storage and minimize the need to scale your storage on-premises. You also retain low-latency access to your frequently accessed data. </li>
</ul>
</li>
<li><strong>Tape gateway</strong>: Back up your data to Amazon S3 using your existing tape-based processes as public or VPC (private)<ul>
<li><strong>VTL</strong> (Virtual Tape Library) is a library/collection of backup tapes that can be backed up</li>
</ul>
</li>
</ul>
<h2 id="aws-backup">AWS Backup<a class="headerlink" href="#aws-backup" title="Permanent link">&para;</a></h2>
<p>centrally manage and automate backups across AWS services, as well as on-premises servers</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../01-Introduction/" title="1. Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                1. Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../03-Network/" title="3. Network" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                3. Network
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Rafael Nieto Esteve
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8e03edeb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>