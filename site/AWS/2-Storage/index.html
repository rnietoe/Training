



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Training Documentation">
      
      
      
        <meta name="author" content="Rafael Nieto Esteve">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>2. Storage - rnietoe training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.adb8469c.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
      <script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#2-storage" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="rnietoe training" aria-label="rnietoe training" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              rnietoe training
            </span>
            <span class="md-header-nav__topic">
              
                2. Storage
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="rnietoe training" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    rnietoe training
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Training index" class="md-nav__link">
      Training index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      AWS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        AWS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../0-AWS-Solutions-Architect-Associate/" title="AWS Architect" class="md-nav__link">
      AWS Architect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../1-Introduction/" title="1. Introduction" class="md-nav__link">
      1. Introduction
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        2. Storage
      </label>
    
    <a href="./" title="2. Storage" class="md-nav__link md-nav__link--active">
      2. Storage
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glacier" class="md-nav__link">
    Glacier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efs" class="md-nav__link">
    EFS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-an-efs-shared-by-two-ec2-instances" class="md-nav__link">
    How to create an EFS shared by two EC2 instances:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ebs" class="md-nav__link">
    EBS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fsx" class="md-nav__link">
    FSx
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3-Network/" title="3. Network" class="md-nav__link">
      3. Network
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../4-Compute/" title="4. Compute" class="md-nav__link">
      4. Compute
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../5-Security/" title="5. Security" class="md-nav__link">
      5. Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../6-Management/" title="6. Management and Governance" class="md-nav__link">
      6. Management and Governance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../7-Architecture/" title="HA Architecture" class="md-nav__link">
      HA Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../8-Databases/" title="8. Databases" class="md-nav__link">
      8. Databases
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Git
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Git
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/1-Git-Essential-Training_The-Basics/" title="Git Essential Training: The Basics" class="md-nav__link">
      Git Essential Training: The Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/2-Git_Branches-Merges-and-Remotes/" title="Git: Branches, Merges, and Remotes" class="md-nav__link">
      Git: Branches, Merges, and Remotes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/3-Git-Intermediate-Techniques/" title="Git Intermediate Techniques" class="md-nav__link">
      Git Intermediate Techniques
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      React
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        React
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Building-React-and-ASP.NET-Core-Applications/" title="Building React and ASP.NET Core Applications" class="md-nav__link">
      Building React and ASP.NET Core Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Become a React Developer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Become a React Developer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/1-Learning-React-js/" title="Learning React.js" class="md-nav__link">
      Learning React.js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/2-React.js-Essential-Training/" title="React.js Essential Training" class="md-nav__link">
      React.js Essential Training
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Security
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Security/Web-Security-OAuth-And-OpenID-Connect/" title="Web Security: OAuth and OpenID Connect" class="md-nav__link">
      Web Security: OAuth and OpenID Connect
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#s3" class="md-nav__link">
    S3
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#glacier" class="md-nav__link">
    Glacier
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#efs" class="md-nav__link">
    EFS
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-create-an-efs-shared-by-two-ec2-instances" class="md-nav__link">
    How to create an EFS shared by two EC2 instances:
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ebs" class="md-nav__link">
    EBS
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fsx" class="md-nav__link">
    FSx
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rnietoe/Training/edit/master/docs/AWS/2-Storage.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="2-storage">2. Storage<a class="headerlink" href="#2-storage" title="Permanent link">&para;</a></h1>
<h2 id="s3">S3<a class="headerlink" href="#s3" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS S3</code></strong> is <strong>Object-based</strong> for the safe storage of <strong>flat</strong> files such as text files, videos, pictures and any other flat file from 0 to 5 tb. The object has a key (filename), value (data), versionID, metadata, encryption, and security by ACL (<strong>A</strong>ccess <strong>C</strong>ontrol <strong>L</strong>ists), torrent and Bucket Policies </p>
<div class="admonition info">
<p class="admonition-title">Objects stored in S3 are stored in multiple servers in multiple facilities across AWS</p>
</div>
<p><strong>Buckets</strong> are folders/containers for everything that you store in S3. S3 bucket names are <strong>global</strong>, and must be unique. Universal namespaces are like https://s3-region_name.amazonaws.com/bucket_name. The response code is http 200 when file upload succeeds.</p>
<div class="admonition danger">
<p class="admonition-title">Create new files are read inmediately. Updates and deletes takes a little bit of time to propagate.</p>
</div>
<p>S3 classes:</p>
<ul>
<li><strong>S3 Standard</strong>: Frequently accessed data</li>
<li><strong>S3 - IA</strong> (<strong>I</strong>nfrequently <strong>A</strong>ccessed)</li>
<li><strong>S3 One Zone - IA</strong> (multiple AZ not required) aka <strong>RRS</strong></li>
<li><strong>S3 - Intelligent Tiering</strong>, using machine learning to move files to the most cost-effective access tier</li>
<li><strong>S3 Glacier</strong> (low cost storage. retrieval times from 2 minutes to hours)</li>
<li><strong>S3 Glacier Deep Archive</strong> (lowest-cost. retrieval time of 12 hours is acceptable)</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">It does not make sense to use S3 standard. Instead, use S3 - Intelligent Tiering to save money</p>
</div>
<p>More features:</p>
<ul>
<li>Unlimited storage</li>
<li>We can use the bucket to host a <strong>static website</strong> using S3 with option <code>static website hosting</code> eanbled, with index.html and error.html. Dynamic website can not be hosted on S3.</li>
<li>Encryption:<ul>
<li>Encryption in Transit, using https (SSL/TLS)</li>
<li>Encryption at Rest:<ul>
<li>In the server side (<strong>S</strong>erver <strong>S</strong>ide <strong>E</strong>ncryption):<ul>
<li><strong>SSE-S3</strong>: An encryption key that Amazon S3 creates, manages, and uses for you.</li>
<li><strong>SSE-KMS</strong>: An encryption key protected by AWS <strong>K</strong>ey <strong>M</strong>anagament <strong>S</strong>ervice</li>
<li><strong>SSE-C</strong> with customer provided keys</li>
</ul>
</li>
<li>In the client side - encrypted before uploading</li>
</ul>
</li>
</ul>
</li>
<li>Versioning (disabled by default):<ul>
<li>usefull as backup tool</li>
<li><strong>MFA Delete</strong> setting: an additional layer of security that requires MFA for changing Bucket Versioning settings and permanently deleting object versions. To modify MFA delete settings, use the AWS CLI, AWS SDK, or the Amazon S3 REST API.</li>
<li>Cannot be disabled once enabled</li>
<li>Uploaded new verions are <strong>private</strong> by default</li>
<li>Deleting a file create a new version (<strong>deleted marker</strong>), then restoring the file recovers all previous versions.</li>
<li>Integrated with lifecycle rules</li>
</ul>
</li>
<li>
<p><strong>S3 Transfer Acceleration</strong> takes advantage of Amazon CloudFront (edge location - cache) using Amazon internal network (no internet). It enables fast, easy and secure transfers of files to and from your bucket.</p>
<ul>
<li><a href="https://s3-accelerate-speedtest.s3-accelerate.amazonaws.com/en/accelerate-speed-comparsion.html">Speed Comparison Tool</a></li>
</ul>
</li>
<li>
<p><strong>Cross Region Replication</strong>: replicate a bucket from a region to another:</p>
<ul>
<li>From S3 Management tab, select <code>Create replication rule</code></li>
<li>Create a new role and select the source bucket and destination bucket. Replicated buckets can be in different AWS accounts</li>
<li>Replication requires versioning to be enable on the source and destionation buckets.</li>
<li>we can change the storage class for the replicated objetcs</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">replication starts when files are added and updated later. Deletes are not replicated. Permissions and previous versions are not replicated</p>
</div>
</li>
<li>
<p>Use <strong>S3 Lifecycle</strong> rules to define actions you want AWS S3 to take during an object's lifetime such as <strong>transitioning</strong> objects to another storage class, archiving them, or deleting them after a specified period of time.</p>
</li>
<li><strong>Multipart uploads</strong> use multithreading to upload large files to S3 buckets <strong>in parallel</strong> (the parts of the file are uploaded in parallel). recommended for &gt; 100mb and required for &gt; 5Gb</li>
<li><strong>AWS DataSync</strong> is used to move large amounts of data from on-premise to AWS S3, EFS, FSx, etc.</li>
<li><strong><code>AWS DMS</code></strong> (<strong>D</strong>atabase <strong>M</strong>igrations <strong>S</strong>ervice) is the best choice for conventional database migrations to AWS.<ul>
<li>homogenous: sample of Oracle to Oracle</li>
<li>heterogenous with SCT (<strong>S</strong>chema <strong>C</strong>onversion <strong>T</strong>ool): sample of SQL Server to Aurora</li>
</ul>
</li>
<li><a href="https://aws.amazon.com/s3/faqs/">General S3 FAQs</a></li>
</ul>
<p><a href="https://aws.amazon.com/s3/pricing/">S3 Pricing</a> depends on:</p>
<ul>
<li>Storage class</li>
<li>Storage</li>
<li>Requests</li>
<li>Data transfer</li>
<li>Transfer acceleration</li>
<li>Cross region replication</li>
</ul>
<p>To upload a file larger than 160 GB, use the AWS CLI, AWS SDK, or Amazon S3 REST API.</p>
<p>S3 Security:</p>
<ul>
<li>Uploaded files are <strong>private</strong> by default</li>
<li>Bucket policies applies to the entire bucket (like one hosting a static S3 website - public) </li>
<li>Bucket ACLs. Object policies applies to an individual file.</li>
<li><strong>Public</strong> bucket policy sample:
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-09-08&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">identify</span> <span class="err">the</span> <span class="err">document</span> <span class="err">structure</span>
    <span class="nt">&quot;Statement&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Sid&quot;</span><span class="p">:</span> <span class="s2">&quot;PublicReadGetObject&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">statement</span> <span class="err">id</span>
            <span class="nt">&quot;Effect&quot;</span><span class="p">:</span> <span class="s2">&quot;Allow&quot;</span><span class="p">,</span> <span class="err">//</span> <span class="err">allow</span> <span class="err">|</span> <span class="err">deny</span>
            <span class="nt">&quot;Principal&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Action&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;s3:GetObject&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;Resource&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;arn:aws:s3:::BUCKET_NAME/*&quot;</span> 
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div></li>
</ul>
<p><strong>S3 Objetc lock</strong> are objects <strong>W</strong>ritten <strong>O</strong>nce and <strong>R</strong>ead <strong>M</strong>any. WORM model. Objects (the whole bucket or individual files) became unmodificable and undeletable:</p>
<ul>
<li>Governance mode: some users are grant with permissions to alter settings or delete the object version</li>
<li>Compliance mode: objects version cannot be modified or deleted, even by the root user</li>
</ul>
<p>S3 Performance:</p>
<ul>
<li>Use <strong>prefixes</strong> to improve performance: path between the bucket and file</li>
<li>Use SSE-KMS have limitations</li>
<li>Use <strong>Multipart uploads</strong> </li>
<li>Use downloads with <strong>S3 Byte-Range Fetches</strong></li>
<li>Use <strong>S3 Select</strong>/<strong>Glacier Select</strong> using SQL to download only the subset of data we need from ZIP or CSV files </li>
</ul>
<h2 id="glacier">Glacier<a class="headerlink" href="#glacier" title="Permanent link">&para;</a></h2>
<p>Glacier pricing:</p>
<ul>
<li>storage</li>
<li>Data Retrieval times</li>
</ul>
<p><strong>S3 Glacier Vault Lock Policy</strong>: compliance controls for S3 Glacier with a Vault Lock policy. The policy can no longer be changed</p>
<h2 id="efs">EFS<a class="headerlink" href="#efs" title="Permanent link">&para;</a></h2>
<p>Based on <strong>NFSv4</strong>, Amazon EFS (<strong>E</strong>lastic <strong>F</strong>ile <strong>S</strong>ystem) is a mountable <strong>file</strong> storage service for EC2 (linux), but has no connection to S3 which is an object storage service.</p>
<p>Data is stored across multiple AZ's within a region</p>
<h3 id="how-to-create-an-efs-shared-by-two-ec2-instances">How to create an EFS <strong>shared</strong> by two EC2 instances:<a class="headerlink" href="#how-to-create-an-efs-shared-by-two-ec2-instances" title="Permanent link">&para;</a></h3>
<ol>
<li>From AWS EFS, <code>Create file system</code></li>
<li>
<p>Create EC2 instances with following user data: </p>
<div class="codehilite"><pre><span></span><code><span class="ch">#!/bin/bash</span>
yum update -y
yum install httpd -y
service httpd start
chkconfig httpd on
yum install amazon-efs-utils -y
</code></pre></div>

</li>
<li>
<p>default SG require inbound rule of type NFSv4 (<strong>N</strong>etwork <strong>F</strong>ile <strong>S</strong>ystem, port 2049) with source SG WebDMZ</p>
</li>
<li>
<p>connect to the EC2 instances, and then mount EFS:</p>
<div class="codehilite"><pre><span></span><code><span class="nb">cd</span> /var/www/html
<span class="nb">cd</span> ..
mount -t efs -o tls fs-9816b269:/ /var/www/html   <span class="c1"># this command comes from `EFS - Amazon EC2 mount instructions from local VPC`</span>
<span class="nb">cd</span> html
<span class="nb">echo</span> <span class="s2">&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;using EFS&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span> &gt; index.html
</code></pre></div>

</li>
</ol>
<h2 id="ebs">EBS<a class="headerlink" href="#ebs" title="Permanent link">&para;</a></h2>
<p>AWS EBS (<strong>E</strong>lastic <strong>B</strong>lock <strong>S</strong>torage) is like a virtual hard disk in the cloud. This is a <strong>block</strong> level storage service for use with AWS EC2 and again has no connection to S3.</p>
<p>EBS cannot be shared by two EC2 instances</p>
<div class="admonition danger">
<p class="admonition-title">an Amazon EBS volume attached as an additional disk (not the root volume) can be detached without stopping the instance</p>
</div>
<p>EBS Types:</p>
<ul>
<li>SSD (<strong>S</strong>olid <strong>S</strong>tate <strong>D</strong>rive)<ul>
<li>GP2 - General Purpose</li>
<li>IO1 - Provisioned IOPS - Input Output per second - high perfrmance</li>
</ul>
</li>
<li>HDD (<strong>H</strong>ard <strong>D</strong>isk <strong>D</strong>rive)<ul>
<li>ST1 - Throughtput optimised - Low cost for frequently access</li>
<li>SC1 - Cold HDD - Lowest cost for less frequently access</li>
<li>Magnetic - Previous generation</li>
</ul>
</li>
</ul>
<p><img alt="" src="../img/ebs.PNG" /></p>
<p>HDD based volumes will always be less expensive than SSD types. </p>
<p>EBS Pricing depends on:</p>
<ul>
<li>Volumes</li>
<li>Snapshots</li>
<li>Data transfer</li>
</ul>
<h2 id="fsx">FSx<a class="headerlink" href="#fsx" title="Permanent link">&para;</a></h2>
<ul>
<li>AWS FSx for windows file server - MS Windows file system<ul>
<li>Based on SMB (Windows <strong>S</strong>erver <strong>M</strong>essage <strong>B</strong>lock)</li>
</ul>
</li>
<li>AWS FSx for Lustre<ul>
<li>Optimised file system</li>
<li>can store data on S3</li>
</ul>
</li>
</ul>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../1-Introduction/" title="1. Introduction" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                1. Introduction
              </span>
            </div>
          </a>
        
        
          <a href="../3-Network/" title="3. Network" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                3. Network
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Rafael Nieto Esteve
          </div>
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"../.."}})</script>
      
    
  </body>
</html>