



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Training Documentation">
      
      
      
        <meta name="author" content="Rafael Nieto Esteve">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.5.1">
    
    
      
        <title>4. Compute - rnietoe training</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.1b62728e.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#03a9f4">
      
    
    
      <script src="../../assets/javascripts/modernizr.268332fc.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="light-blue" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#4-compute" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="rnietoe training" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              rnietoe training
            </span>
            <span class="md-header-nav__topic">
              
                4. Compute
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="rnietoe training" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    rnietoe training
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/rnietoe/Training/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Training@rnietoe
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Training index" class="md-nav__link">
      Training index
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      AWS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        AWS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../00-AWS-Solutions-Architect-Associate/" title="AWS Architect" class="md-nav__link">
      AWS Architect
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../01-Introduction/" title="1. Introduction" class="md-nav__link">
      1. Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../02-Storage/" title="2. Storage" class="md-nav__link">
      2. Storage
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../03-Network/" title="3. Network" class="md-nav__link">
      3. Network
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        4. Compute
      </label>
    
    <a href="./" title="4. Compute" class="md-nav__link md-nav__link--active">
      4. Compute
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ec2" class="md-nav__link">
    EC2
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#placement-groups" class="md-nav__link">
    Placement groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-types" class="md-nav__link">
    Instance types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pricing-models" class="md-nav__link">
    Pricing models:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ami" class="md-nav__link">
    AMI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-ec2" class="md-nav__link">
    How to create EC2:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-connect-to-ec2" class="md-nav__link">
    How to connect to EC2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-a-static-website-on-s3" class="md-nav__link">
    How to create a static website on S3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-build-a-web-server" class="md-nav__link">
    How to build a web server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elastic-beanstalk" class="md-nav__link">
    Elastic Beanstalk
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrieving-instance-metadata" class="md-nav__link">
    Retrieving instance metadata
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    Lambda
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch" class="md-nav__link">
    Batch
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../05-Security/" title="5. Security" class="md-nav__link">
      5. Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../06-Management/" title="6. Management and Governance" class="md-nav__link">
      6. Management and Governance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../07-Architecture/" title="7. Hight Availability Architecture" class="md-nav__link">
      7. Hight Availability Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../08-Databases/" title="8. Databases" class="md-nav__link">
      8. Databases
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../09-Applications/" title="9. Applications" class="md-nav__link">
      9. Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../10-Media/" title="10. Media" class="md-nav__link">
      10. Media
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-12" type="checkbox" id="nav-2-12">
    
    <label class="md-nav__link" for="nav-2-12">
      CloudFormation
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-12">
        CloudFormation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CloudFormation/06-CloudFormation/" title="CloudFormation" class="md-nav__link">
      CloudFormation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Git
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Git
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/1-Git-Essential-Training_The-Basics/" title="Git Essential Training: The Basics" class="md-nav__link">
      Git Essential Training: The Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/2-Git_Branches-Merges-and-Remotes/" title="Git: Branches, Merges, and Remotes" class="md-nav__link">
      Git: Branches, Merges, and Remotes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Git/3-Git-Intermediate-Techniques/" title="Git Intermediate Techniques" class="md-nav__link">
      Git Intermediate Techniques
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      React
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        React
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Building-React-and-ASP.NET-Core-Applications/" title="Building React and ASP.NET Core Applications" class="md-nav__link">
      Building React and ASP.NET Core Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Become a React Developer
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Become a React Developer
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/" title="Index" class="md-nav__link">
      Index
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/1-Learning-React-js/" title="Learning React.js" class="md-nav__link">
      Learning React.js
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../React/Become-a-React-Developer/2-React.js-Essential-Training/" title="React.js Essential Training" class="md-nav__link">
      React.js Essential Training
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Security
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Security
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Security/Web-Security-OAuth-And-OpenID-Connect/" title="Web Security: OAuth and OpenID Connect" class="md-nav__link">
      Web Security: OAuth and OpenID Connect
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ec2" class="md-nav__link">
    EC2
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#placement-groups" class="md-nav__link">
    Placement groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-types" class="md-nav__link">
    Instance types
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pricing-models" class="md-nav__link">
    Pricing models:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ami" class="md-nav__link">
    AMI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-ec2" class="md-nav__link">
    How to create EC2:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-connect-to-ec2" class="md-nav__link">
    How to connect to EC2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-create-a-static-website-on-s3" class="md-nav__link">
    How to create a static website on S3
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-build-a-web-server" class="md-nav__link">
    How to build a web server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elastic-beanstalk" class="md-nav__link">
    Elastic Beanstalk
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retrieving-instance-metadata" class="md-nav__link">
    Retrieving instance metadata
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lambda" class="md-nav__link">
    Lambda
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#batch" class="md-nav__link">
    Batch
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/rnietoe/Training/edit/master/docs/AWS/04-Compute.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="4-compute">4. Compute<a class="headerlink" href="#4-compute" title="Permanent link">&para;</a></h1>
<h2 id="ec2">EC2<a class="headerlink" href="#ec2" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS EC2</code></strong> (Elastic Compute Cloud) is a VM in the cloud. It is a web service that provides resizeable compute capacity in the cloud.</p>
<p>AWS originally used a modified version of the <strong>Xen</strong> Hypervisor to host EC2. In 2017, AWS began rolling out their own Hypervisor called <strong>Nitro</strong>.</p>
<p><a href="https://aws.amazon.com/blogs/aws-cost-management/launch-resource-optimization-recommendations/">Resource Optimization</a> gives recommendations to help saving money</p>
<p><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/dedicated-hosts-recovery.html">Host recovery</a> restarts EC2 instances when a problem is detected or when a new host is available</p>
<h3 id="placement-groups">Placement groups<a class="headerlink" href="#placement-groups" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Clustered</strong>: Group homogenous EC2 instances within a <strong>single AZ</strong> for <strong>network performance</strong></li>
<li><strong>Spread</strong>: Individial EC2 instances are placed on distinct rack within one region for HW errors<ul>
<li>you can only have a maximum of <strong>7</strong> running instances per AZ</li>
</ul>
</li>
<li><strong>Partitioned</strong>: Multiple EC2 instances in the same rack</li>
<li><strong>EC2 fleet</strong> - multiple EC2 instances managed by <strong><code>AWS System Manager</code></strong>  </li>
<li><strong>Spot fleet</strong> - multiple Spot (and on demand) instances </li>
</ul>
<p>The name of your placement group must be unique within your AWS Account</p>
<p>There is no charge for creating a placement group</p>
<h3 id="instance-types">Instance types<a class="headerlink" href="#instance-types" title="Permanent link">&para;</a></h3>
<ul>
<li>General Purpose por basic apps: <strong>T2</strong> (burst performance), <strong>M5</strong>, <strong>M4</strong> and <strong>M3</strong>. They provie balance of memory and CPU</li>
<li>Compute Optimized for CPU intensive apps: <strong>C5</strong>, <strong>C5n</strong> <strong>C4</strong> and <strong>C3</strong></li>
<li>Memory Optimized for eXtreme memory requirements: <strong>X1e</strong>, <strong>X1</strong>, <strong>R4</strong> and <strong>R3</strong></li>
<li>Storage Optimized for high Input/Output access: <strong>H1</strong>, <strong>I3</strong>, <strong>I3en</strong> and <strong>D2</strong></li>
<li>
<p>Advance Computing for hardware compute requirements: <strong>P3</strong>, <strong>P2</strong>, <strong>G3</strong> and <strong>F1</strong></p>
<p><img alt="EC2-instances-types" src="../img/EC2-instances-types.png" /></p>
</li>
</ul>
<p>Change the instance type required stopping the instance previously.</p>
<h3 id="pricing-models">Pricing models:<a class="headerlink" href="#pricing-models" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>On Demand</strong>: low cost, paying by hour or second. You have full control over its lifecycle—you decide when to launch, stop, hibernate, start, reboot, or terminate it. Sample: when <strong>task run uninterrupted</strong> from start to finish</li>
<li><strong>Reserved</strong>: the most economical option for <strong>long-term workloads</strong> with predictable usage patterns. Contract terms are 1 to 3 years. It includes different discounts<ul>
<li><strong>Standard</strong> Reserved instances (75% off on demand instances). Cannot be moved between regions. You can choose if a Reserved Instance applies to either a specific AZ, or an entire Region, but you cannot change the region.</li>
<li><strong>Convertible</strong> Reserved instances (54%)</li>
<li><strong>Schedule</strong> Reserved instances, based on times</li>
</ul>
</li>
<li><strong>Spot</strong>: taket advantage of <strong>unused</strong> EC2 capacity. It can accept interruptions. Used for various stateless, fault-tolerant, or flexible applications such as big data, containerized workloads, CI/CD, web servers, HPC (high-performance computing), and other test &amp; development workloads. Extra charge when you terminate the instance<ul>
<li>Spot Instances are available at up to a 90% discount compared to On-Demand prices.</li>
<li>It is possible that your Spot Instance is terminated before the warning can be made available.</li>
<li>In rare situations, <strong>Spot blocks</strong> may be interrupted due to Amazon EC2 capacity needs. In these cases, AWS provides a two-minute warning before the instance is terminated, and customers are not charged for the terminated instances even if they have used them.</li>
<li><strong>Capacity Rebalancing</strong> helps you maintain workload availability by proactively augmenting your fleet with a new Spot Instance before a running Spot Instance receives the two-minute Spot Instance interruption notice. When Capacity Rebalancing is enabled, Auto Scaling or Spot Fleet attempts to proactively replace Spot Instances that have received a rebalance recommendation, providing the opportunity to rebalance your workload to new Spot Instances that are not at elevated risk of interruption. Capacity Rebalancing complements the <strong>capacity optimized allocation strategy</strong> (which is designed to help find the most optimal spare capacity) and the <strong>mixed instances policy</strong> (which is designed to enhance availability by deploying instances across multiple instance types running in multiple AZs).</li>
</ul>
</li>
<li><strong>Dedicated</strong>: physical EC2 server. <ul>
<li>It reduces cost using your SW licenses (importing your licensed VM). </li>
<li>Also when multitenant not supported by law (compliance)</li>
</ul>
</li>
</ul>
<p>Tenancy:</p>
<ul>
<li><strong>Shared</strong>: (default) multiple customers share the hardware instance. Cost reduced</li>
<li><strong>Dedicated</strong> instance: (not free) launch the instance in a dedicated host for one customer, but it may be moved to other of my hosts on restart</li>
<li><strong>Dedicated host</strong>: launch the instance in a dedicated host for one customer</li>
</ul>
<p>EC2 Pricing depends on:</p>
<ul>
<li>Clock hours of server time</li>
<li>instance type</li>
<li>pricing model (on demand, reserved, spot, dedicated host)</li>
<li>number of instances</li>
<li>load balancing</li>
<li>detailed monitoring</li>
<li>auto scaling</li>
<li>Elastic IP Addresses</li>
<li>Operative Systems and sw packages</li>
<li>Windows instances are billed by the full hour, and partial hours are billed as full hours</li>
</ul>
<h3 id="ami">AMI<a class="headerlink" href="#ami" title="Permanent link">&para;</a></h3>
<ul>
<li>AMI (Amazon Machine Image) are instance image snapshots of different Operative System<ul>
<li><strong>public</strong> for everyone</li>
<li><strong>explicit</strong> for specified accounts</li>
<li><strong>implicit</strong> for the owner only (default)</li>
</ul>
</li>
<li>AMI are based on region, OS, architecture (32 or 64 bits), launch permissions and storage for the root volume (EBS or <strong>Instance store</strong> - ephemeral storage)<ul>
<li>EC2 instance with <strong>Instance Store</strong> can't be stopped</li>
<li>Reboot does not cause the data to be deleted on an <strong>instance store</strong> volume</li>
<li><strong>Instance Store</strong> does not appear in the AWS EC2 Volume list</li>
</ul>
</li>
<li>To use <strong>hibernation</strong>, the root volume must be an encrypted EBS volume and RAM must be less than 150gb</li>
</ul>
<p>AWS does not copy launch permissions, tags, or SG rules from the source AMI to the new AMI. </p>
<ul>
<li>You must first deregister the AMI before you can delete the snapshot</li>
<li><strong>Snapshots</strong> are incremental</li>
<li>You can use AWS APIs, CLI or the AWS Console to copy snapshots, share snapshots, and create volumes from snapshots.</li>
<li>
<p>Volumes exist on EBS. Snapshots and instance store exist on S3. </p>
<div class="codehilite"><pre><span></span>aws ec2 create-snapshot
</pre></div>

</li>
</ul>
<div class="admonition danger">
<p class="admonition-title">Use snapshots and AMI to change EC2 volumes (AZ and encryption).</p>
</div>
<h3 id="how-to-create-ec2">How to create EC2:<a class="headerlink" href="#how-to-create-ec2" title="Permanent link">&para;</a></h3>
<ol>
<li>From AWS EC2, <code>Launch instance</code></li>
<li>Select AMI, for example: Amazon Linux 2 AMI</li>
<li>Choose an Instance Type (t2 micro - free tier)</li>
<li>
<p>Configure Instance Details (number of instances) </p>
<div class="admonition danger">
<p class="admonition-title">Enable CloudWatch detailed monitoring is not free</p>
</div>
</li>
<li>
<p>Add Storage. Root and EBS volume types allow encryption and delete on termination (turn off by default on EBS) </p>
<div class="admonition note">
<p class="admonition-title">EC2 instance and volume are in the same AZ</p>
</div>
</li>
<li>
<p>Add tags like Name, Department or Employee_Id</p>
</li>
<li>
<p>Configure <strong>Security Groups</strong>: virtual <strong>firewalls</strong> to enable traffic - disabled by default</p>
<ul>
<li>SG support "allow" rules only. Use <strong>Network ACL</strong> to block specific IPs instead of SG</li>
<li>All inbound traffic (<strong>ingress</strong>) is blocked by default and all outbound traffic (<strong>egrees</strong>) is allowed </li>
<li>SG are <strong>stateful</strong> (no inbound traffic is allowed without request while all outbound traffic is allowed)</li>
<li>network ACLs are stateless (outbound traffic must be specified)</li>
<li>Security groups operate at the instance level, not to subnet as NACL</li>
<li>Linux=SSH port 22. Microsoft Windows=RDP (Remote Desktop Protocol) port 3389. http/https ports 80/443</li>
<li>default SG for linux instances brings already inbound with SSH. Default SG for windows instances bring RDP</li>
<li>SG changes are take effect immediately</li>
<li>one or more SG can be assigned to EC2 instance. EC2 and SG relation is many to many</li>
<li>a maximum of 5 SGs per instance</li>
</ul>
<p><img alt="" src="../img/sg_vs_nacl.png" /></p>
</li>
<li>
<p>Launch using a key pair (public and private key)</p>
</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">Always design for failure. Have one EC2 instance in each AZ, using clustering and backups</p>
</div>
<div class="admonition danger">
<p class="admonition-title">implement elasticity with auto scaling, ELB, decoupling applications and running tasks in parallel</p>
</div>
<h3 id="how-to-connect-to-ec2">How to connect to EC2<a class="headerlink" href="#how-to-connect-to-ec2" title="Permanent link">&para;</a></h3>
<p>Using AWS Console, select the EC2 instance and clic on the <code>Connect</code> button. Password required</p>
<p>Using putty:</p>
<ol>
<li>
<p>Download <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html">putty</a> and load PK file created at <code>EC2/Key Pairs</code> (rnietoe.ppk) using putty gen.</p>
<p><strong>Key pair</strong> can created or imported in AWS. You can create you key pair with the following command, keep the PK and import the public key in AWS:</p>
<div class="codehilite"><pre><span></span>ssh-keygen -C rnietoe@gmail.com -f ~/.ssh/rnietoe
</pre></div>

</li>
<li>
<p>Configure SSH Auth with PK</p>
</li>
<li>Copy IP address to the session host name field</li>
<li>
<p>Open connection, login as <code>ec2-user</code> (default user) and type <code>sudo su command</code></p>
<p><img alt="" src="../img/ec2-putty.PNG" /></p>
</li>
</ol>
<p>Using gitbash and install a web server:</p>
<div class="codehilite"><pre><span></span><span class="nb">cd</span> <span class="s2">&quot;C:\Users\rniet\OneDrive\AWS&quot;</span>
CHMOD <span class="m">400</span> rnietoe.pem <span class="c1"># change permissions to unlock my key down</span>
ssh ec2-user@3.80.39.184 -i rnietoe.pem
sudo su
uname -a  <span class="c1"># software details</span>
cat ~/.ssh/authorized_keys  <span class="c1"># the public key</span>
</pre></div>

<div class="codehilite"><pre><span></span><span class="k">while</span> true<span class="p">;</span> <span class="k">do</span> echo<span class="p">;</span> <span class="k">done</span> <span class="c1"># to monitor the CPU usage</span>
</pre></div>

<p>Using CLI</p>
<ol>
<li>Download the windows installer from <a href="https://aws.amazon.com/cli/?nc1=h_ls">AWS Command Line Interface</a> and installe it</li>
<li>Now we have the <strong>aws</strong> command in our prompt</li>
<li>Configure IAM User with Programmatic access </li>
<li>
<p>Download the access key and the secret access key:</p>
<div class="codehilite"><pre><span></span>aws configure
aws configure --profile profile_name <span class="c1"># when we want to work with cli profiles</span>
<span class="c1"># once typep the access key, the secret access key, the default region and the output format (json/text)</span>
aws ec2 describe-regions
<span class="c1"># use :q to exit from command output</span>
aws &lt;command&gt; --profile &lt;profile_name&gt; <span class="c1"># when we want to execute commands with a specific profile</span>
<span class="nb">set</span> <span class="nv">AWS_PROFILE</span><span class="o">=</span>&lt;profile_name&gt; <span class="c1"># set/unset default profile</span>
<span class="nb">echo</span> <span class="nv">$AWS_PROFILE</span>
aws sts get-caller-identity <span class="c1"># print out account and user info    </span>
cat ~/.aws/config   <span class="c1"># file containing profile configuration</span>
cat ~/.aws/credentials  <span class="c1"># file containing profile credentials   </span>
rm -rf ~/.aws
</pre></div>

<p>We must use <strong>roles</strong> for security reasons instead of saving credentials (anyone could access to the .aws directory). Roles are global, they are not specified any region. Create a role to allows EC2 to use S3 as an admin:</p>
<ol>
<li>Go to <code>IAM/Roles</code> and create a new role</li>
<li>Select <code>EC2</code> as the type of trusted entity</li>
<li>Attach <code>AmazonS3FullAccess</code> permissions policies</li>
<li>Go to <code>EC2</code>, select the instance and actions/instance settings/attach/replace iam role</li>
<li>Then we can delete .aws directory with credential and still running <code>aws s3 ls</code></li>
</ol>
</li>
</ol>
<h3 id="how-to-create-a-static-website-on-s3">How to create a static website on S3<a class="headerlink" href="#how-to-create-a-static-website-on-s3" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>aws configure <span class="c1"># enter user´s accesskeys and us-east-1 as default region</span>
aws s3 mb s3://rnietoe2 <span class="c1"># make bucket command</span>
aws s3 ls <span class="c1"># list all s3 instances</span>

<span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span> &gt; hello_world.txt
aws s3 cp hello_world.txt s3://rnietoe2 <span class="c1"># upload: ./hello_world.txt to s3://rnietoe2/hello_world.txt</span>

<span class="nb">cd</span> ~ <span class="c1"># go to home directory</span>
<span class="nb">cd</span> .aws <span class="c1"># go the hidden directory</span>
nano credentials <span class="c1"># display access keys</span>
</pre></div>

<p>More details to create Bootstrap actions to install additional software are <a href="https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-plan-bootstrap.html">here</a></p>
<p>bootstrapping: providing code to be run on an instance at launch</p>
<h3 id="how-to-build-a-web-server">How to build a web server<a class="headerlink" href="#how-to-build-a-web-server" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>sudo su
yum update -y <span class="c1"># check for updates</span>
yum install httpd -y <span class="c1"># install apache </span>
<span class="nb">cd</span> /var/www/html <span class="c1"># create index.html in this path</span>
nano index.html
&lt;html&gt;&lt;body&gt;&lt;h1&gt;This is server <span class="m">1</span>&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
service httpd start <span class="c1"># sudo systemctl start httpd # start apache service</span>
chkconfig on <span class="c1"># start apache on restarts</span>
</pre></div>

<h2 id="elastic-beanstalk">Elastic Beanstalk<a class="headerlink" href="#elastic-beanstalk" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS Elastic Beanstalk</code></strong> deploy and manage applications in the AWS cloud without worrying about the infrastructure that runs those applications. Some platforms are:</p>
<ul>
<li>docker</li>
<li>multi-container docker</li>
<li>tomcat (php and apache)</li>
<li>.net (windows and iis)</li>
<li>python</li>
<li>...</li>
</ul>
<p>you cannot change the environment tier after creating an environment</p>
<ol>
<li><code>Create Application</code> from <code>Elastic Beanstalk</code></li>
<li>Select PHP as platform and the sample application code</li>
<li>Created environment includes:<ul>
<li>S3 bucket</li>
<li>LB / Target group</li>
<li>Security group (virtual firewall)</li>
<li>EIP</li>
<li>EC2 instance</li>
<li>Launch Configuration / Auto Scaling</li>
<li>CloudWatch alarm</li>
<li>...</li>
</ul>
</li>
</ol>
<div class="codehilite"><pre><span></span>mkdir helloworld
<span class="nb">cd</span> hellowworld
eb init -p PHP
<span class="nb">echo</span> <span class="s2">&quot;Hello World&quot;</span> &gt; index.html
eb create dev-env
eb open
eb deploy <span class="c1"># to deploy updates to the applications</span>
</pre></div>

<h3 id="retrieving-instance-metadata">Retrieving instance metadata<a class="headerlink" href="#retrieving-instance-metadata" title="Permanent link">&para;</a></h3>
<p>Connect to the EC2 instance and <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html">get instance metadata</a> to get information about an instance using ip address <strong>169.254.169.254</strong>:</p>
<div class="codehilite"><pre><span></span>curl http://169.254.169.254/latest/user-data
curl http://169.254.169.254/latest/user-data &gt; bootstrap.txt
cat bootstrap.txt

curl http://169.254.169.254/latest/meta-data
curl http://169.254.169.254/latest/meta-data/local-ipv4
curl http://169.254.169.254/latest/meta-data/public-ipv4
</pre></div>

<h2 id="lambda">Lambda<a class="headerlink" href="#lambda" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS Lambda</code></strong> is the FaaS (Function-as-a-Service) to run your code <strong>globally</strong> without provisioning or managing servers (Serverless).</p>
<ul>
<li>Lambda can be used for Infrastructure as Code.</li>
<li>Lambda, EC2 and ECS supports <strong>hyper-threading</strong> on one or more virtual CPUs.</li>
<li>You can use JSON or YAML for Lambda templates.</li>
<li>The resources section is the only required field in Lambda templates.</li>
<li><strong>Scales out automatically</strong>. (for example, 5 lambda replications running at the same time). Each time your function is triggered, a new and separate instance of that function is started. There are limits, but these can be adjusted on request.</li>
<li>when creating a lambda function, a role is required to provide credentials with rights to other services. This is exactly the same as needing a Role on an EC2 instance to access S3 or DDB. Create a new role selecting the  <code>Simple microservice permissions</code> policy template.</li>
<li>different services can trigger your function,  such as  Api Gateway
    <img alt="" src="../img/lambda-triggers.png" /><ul>
<li>a lambda function can trigger other lambda functions</li>
<li>ALB, Cognito, Lex, Alexa, API Gateway, CloudFront, and Kinesis Data Firehose are all valid direct (synchronous) triggers for Lambda functions.</li>
<li><strong>S3</strong> is one of the valid <strong>asynchronous</strong> triggers.</li>
</ul>
</li>
</ul>
<p>Pricing: </p>
<ul>
<li>number of request<ul>
<li>1 million request per month free</li>
<li>0,20$ next million requests</li>
</ul>
</li>
<li>duration (how long lambda functions are executing for)<ul>
<li>4000.000 gb-seconds per month free, up to 3,2 million seconds of compute time</li>
<li>0,00001667 for every GB second used thereafter</li>
</ul>
</li>
<li>The amount of memory assigned.</li>
<li>additional charges<ul>
<li>when using other AWS services</li>
</ul>
</li>
</ul>
<p>languages supported:</p>
<ul>
<li>node.js</li>
<li>java</li>
<li>c#</li>
<li>Go</li>
<li>Python</li>
</ul>
<p>lambda python sample:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">lambda_handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In lambda handler&quot;</span><span class="p">)</span>

    <span class="n">resp</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;statusCode&quot;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
        <span class="s2">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;Access-Control-Allow-Origin&quot;</span><span class="p">:</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="s2">&quot;body&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello world&quot;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">resp</span>
</pre></div>

<p>triggered in a html:</p>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kd">function</span> <span class="nx">myFunction</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">xhttp</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nx">onreadystatechange</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;my-demo&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">};</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;YOUR-API-GATEWAY-LINK-HERE&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
            <span class="nx">xhttp</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">align</span><span class="o">=</span><span class="s">&quot;center&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Hello <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;my-demo&quot;</span><span class="p">&gt;</span>Cloud Gurus!<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;myFunction()&quot;</span><span class="p">&gt;</span>Click me<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://s3.amazonaws.com/acloudguru-opsworkslab-donotdelete/ACG_Austin.JPG&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>

<p><a href="https://help.acloud.guru/hc/en-us/articles/115003704634">Lambda Troubleshooting</a></p>
<h2 id="batch">Batch<a class="headerlink" href="#batch" title="Permanent link">&para;</a></h2>
<p><strong><code>AWS Batch</code></strong> enables you to easily and efficiently run batch computing <strong>jobs</strong> of any scale on AWS using on-demand and Spot EC2.</p>
<p>like hangfire??</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../03-Network/" title="3. Network" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                3. Network
              </span>
            </div>
          </a>
        
        
          <a href="../05-Security/" title="5. Security" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                5. Security
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Rafael Nieto Esteve
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8e03edeb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>